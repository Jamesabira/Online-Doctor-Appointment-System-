{% extends "patient/base.html" %}

{% block content %}
<div class="container">
  <div class="row mt-4"> 
    <div class="accordion" id="accordionPanelsStayOpenExample">

      <div class="accordion-item mb-2">
        <h2 class="accordion-header" id="panelsStayOpen-headingOne">
          <button class="accordion-button collapsed bg-secondary text-white" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="false" aria-controls="panelsStayOpen-collapseOne">
            <b>Completed Appointments</b>
          </button>
        </h2>
        <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingOne">
          <div class="accordion-body">

            <!-- completed appointments -->
            {% for appointment in appointments %}
              {% if appointment.date_time_end < current.start %}
                <div class="card m-3">
                  <div class="card-header">
                    Appointment No. {{appointment.id}}
                  </div>
                  <div class="card-body">
                    <h5 class="card-title">Date: {{appointment.date}}, Time: {{appointment.time}}</h5>
                    <p class="card-text">Appointment with Dr. {{appointment.doctor.first_name}} {{appointment.doctor.last_name}} on {{appointment.date}}</p>
                    <a href="{% url 'main-chat-view' appointment.id %}" class="btn btn-secondary disabled" target="_blank">Appointment Over</a>
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      </div>

      <div class="accordion-item mb-2">
        <h2 class="accordion-header" id="panelsStayOpen-headingTwo">
          <button class="accordion-button bg-danger text-white" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="true" aria-controls="panelsStayOpen-collapseTwo">
            <b>Active Appointments</b>
          </button>
        </h2>
        <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingTwo">
          <div class="accordion-body">

            <!-- active appointments -->
            {% for appointment in appointments %}
              {% if appointment.date_time_end >= current.start and appointment.date_time_start <= current.start %}
                <div class="card m-3 border-danger">
                  <div class="card-header">
                    Appointment No. {{appointment.id}}
                  </div>
                  <div class="card-body">
                    <h5 class="card-title">Date: {{appointment.date}}, Time: {{appointment.time}}</h5>
                    <p class="card-text">Appointment with Dr. {{appointment.doctor.first_name}} {{appointment.doctor.last_name}} on {{appointment.date}}</p>
                    <a href="{% url 'main-chat-view' appointment.id %}" class="btn btn-success" target="_blank">Start Appointment</a>
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header" id="panelsStayOpen-headingThree">
          <button class="accordion-button bg-primary text-white" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="true" aria-controls="panelsStayOpen-collapseThree">
            <b>Upcomming Appointments</b>
          </button>
        </h2>
        <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingThree">
          <div class="accordion-body">
            <!-- for upcomming appointments -->
            {% for appointment in appointments %}
              {% if appointment.date_time_start > current.start %} 
                <div class="card m-3 border-primary">
                  <div class="card-header bg-primary text-white">
                    Appointment No. {{appointment.id}}
                  </div>
                  <div class="card-body">
                    <h5 class="card-title">Date: {{appointment.date}}, Time: {{appointment.time}}</h5>
                    <p class="card-text">Appointment with Dr. {{appointment.doctor.first_name}} {{appointment.doctor.last_name}} on {{appointment.date}}</p>
                    <a href="{% url 'main-chat-view' appointment.id %}" class="btn btn-primary disabled" target="_blank">Upcomming</a>
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      </div>

    </div>  
  </div>   
</div>

{% endblock %}